class DanToast{static instances=[];constructor(container){this.toastContainer=container;this.toasts=[];this.triggerListeners=new Map();this.showDuration=parseFloat(this.toastContainer.getAttribute('data-show-duration'));this.showEase=this.toastContainer.getAttribute('data-show-ease');this.hideDuration=parseFloat(this.toastContainer.getAttribute('data-hide-duration'));this.hideEase=this.toastContainer.getAttribute('data-hide-ease');this.expandDuration=parseFloat(this.toastContainer.getAttribute('data-expand-duration'));this.expandEase=this.toastContainer.getAttribute('data-expand-ease');this.collapseDuration=parseFloat(this.toastContainer.getAttribute('data-collapse-duration'));this.collapseEase=this.toastContainer.getAttribute('data-collapse-ease');this.boundExpandToasts=this.expandToasts.bind(this);this.boundCollapseToasts=this.collapseToasts.bind(this);this.init()}
init(){this.toastContainer.querySelectorAll('.dan-toast__toast-data').forEach(toast=>{const title=toast.getAttribute('data-title');const message=toast.getAttribute('data-message');const event=toast.getAttribute('data-event');const showTime=parseFloat(toast.getAttribute('data-show-time'))*1000;const trigger=toast.getAttribute('data-trigger');const expireTime=parseFloat(toast.getAttribute('data-expire-time'))*1000;this.addToast(title,message,event,expireTime,trigger,showTime)});this.bindEvents()}
createToastElement(toast,index){const el=document.createElement('div');el.className='dan-toast__toast';el.id=toast.id;if(index===this.toasts.length-1){el.style.opacity=0;el.style.transform='translateY(20px) scale(1)'}else{const previousIndex=index;const previousY=(this.toasts.length-2-previousIndex)*-10;const previousScale=1-((this.toasts.length-2-previousIndex)*0.05);el.style.opacity=1;el.style.transform=`translateY(${previousY}px) scale(${previousScale})`}
el.innerHTML=`
            <div class="dan-toast__toast-content">
                <div class="dan-toast__toast-body">
                    <span class="dan-toast__toast-title">${toast.title}</span>
                    <span class="dan-toast__toast-message">${toast.message}</span>
                </div>
                <div tabindex="0" class="dan-toast__toast-close">
                    <svg viewBox="0 0 24 24" fill="none">
                        <path d="M18 6L6 18M6 6l12 12"/>
                    </svg>
                </div>
            </div>
        `;const closeBtn=el.querySelector('.dan-toast__toast-close');const boundRemoveToast=()=>this.removeToast(toast.id);closeBtn.addEventListener('click',boundRemoveToast);this.triggerListeners.set(toast.id,{element:closeBtn,listener:boundRemoveToast});const finalY=(this.toasts.length-1-index)*-10;const finalScale=1-((this.toasts.length-1-index)*0.05);if(index===this.toasts.length-1){gsap.to(el,{duration:this.showDuration,opacity:1,y:finalY,ease:this.showEase})}else{gsap.to(el,{duration:this.showDuration,y:finalY,scale:finalScale,ease:this.showEase})}
return el}
addToast(title,message,event='pageload',expireTime=5000,trigger=null,showTime=0){const showToast=()=>{const id=Math.random().toString(36).substr(2,9);const newToast={id,title:title,message:message,type:'default'};this.toasts=[...this.toasts,newToast].slice(-3);this.renderToasts()};if(event==='click'&&trigger){const triggerElement=document.querySelector(trigger);if(triggerElement){const boundShowToast=()=>showToast();this.triggerListeners.set(trigger,{element:triggerElement,listener:boundShowToast});triggerElement.addEventListener('click',boundShowToast)}}else{setTimeout(showToast,showTime)}}
removeToast(id){const toast=document.getElementById(id);const isExpanded=this.toastContainer.matches(':hover');if(toast){const remainingToasts=this.toasts.filter(t=>t.id!==id);const toastPositions=new Map();remainingToasts.forEach(t=>{const el=document.getElementById(t.id);if(el){const rect=el.getBoundingClientRect();toastPositions.set(t.id,rect.top)}});const isLastToast=this.toasts[this.toasts.length-1].id===id;gsap.to(toast,{duration:this.hideDuration,opacity:0,y:isExpanded&&isLastToast?30:-30,ease:this.hideEase,onBeforeStart:()=>{this.toasts=remainingToasts;toast.style.pointerEvents="none";remainingToasts.forEach((t,index)=>{const el=document.getElementById(t.id);if(el){if(isExpanded){const expandedGap=10;const newY=(-el.offsetHeight*(remainingToasts.length-1-index))-(expandedGap*(remainingToasts.length-1-index));gsap.to(el,{duration:this.hideDuration,y:newY,ease:this.hideEase})}else{const newY=(-10)*(remainingToasts.length-1-index);gsap.to(el,{duration:this.hideDuration,y:newY,ease:this.hideEase})}}})}})}}
expandToasts(){const expandedGap=10;let totalHeight=0;this.toasts.forEach((toast,index)=>{const el=document.getElementById(toast.id);if(el){if(index===0){totalHeight+=el.offsetHeight}else{totalHeight+=el.offsetHeight+expandedGap}
const expandedY=(-el.offsetHeight*(this.toasts.length-1-index))-(expandedGap*(this.toasts.length-1-index));gsap.to(el,{duration:this.expandDuration,y:expandedY,scale:1,ease:this.expandEase})}});gsap.to(this.toastContainer,{duration:this.expandDuration,height:totalHeight,ease:this.expandEase})}
collapseToasts(){this.toasts.forEach((toast,index)=>{const el=document.getElementById(toast.id);if(el){const collapsedY=(this.toasts.length-1-index)*-10;const collapsedScale=1-((this.toasts.length-1-index)*0.05);gsap.to(el,{duration:this.collapseDuration,y:collapsedY,scale:collapsedScale,ease:this.collapseEase})}});gsap.to(this.toastContainer,{duration:this.collapseDuration,height:"auto",ease:this.collapseEase})}
renderToasts(previousPositions=null){const isExpanded=this.toastContainer.matches(':hover');const oldElements=new Map();if(previousPositions){this.toasts.forEach(toast=>{const el=document.getElementById(toast.id);if(el)oldElements.set(toast.id,el);})}
this.toastContainer.innerHTML='';this.toasts.forEach((toast,index)=>{const el=this.createToastElement(toast,index);this.toastContainer.appendChild(el);if(isExpanded){const expandedGap=10;const expandedY=(-el.offsetHeight*(this.toasts.length-1-index))-(expandedGap*(this.toasts.length-1-index));if(previousPositions&&previousPositions.has(toast.id)){const oldPos=previousPositions.get(toast.id);const newPos=el.getBoundingClientRect().top;const deltaY=oldPos-newPos;if(deltaY<0&&index!==this.toasts.length-1){el.style.transform=`translateY(${deltaY}px) scale(1)`;el.style.opacity=1;gsap.to(el,{duration:this.expandDuration,y:expandedY,scale:1,ease:this.expandEase})}else{el.style.transform=`translateY(${expandedY}px) scale(1)`;el.style.opacity=1}}else{el.style.transform=`translateY(${expandedY}px) scale(1)`;el.style.opacity=1}}})}
bindEvents(){this.toastContainer.addEventListener('mouseenter',this.boundExpandToasts);this.toastContainer.addEventListener('mouseleave',this.boundCollapseToasts)}
destroy(){this.toastContainer.removeEventListener('mouseenter',this.boundExpandToasts);this.toastContainer.removeEventListener('mouseleave',this.boundCollapseToasts);this.triggerListeners.forEach(({element,listener})=>{if(element){element.removeEventListener('click',listener)}});this.triggerListeners.clear();gsap.killTweensOf(this.toastContainer);this.toasts.forEach(toast=>{const el=document.getElementById(toast.id);if(el){gsap.killTweensOf(el)}});this.toasts=[];this.toastContainer.innerHTML=''}
static destroyAllInstances(){DanToast.instances.forEach((instance)=>instance.destroy());DanToast.instances=[]}}
function dancepad_toast(){DanToast.destroyAllInstances();document.querySelectorAll('.dan-toast').forEach(container=>{const instance=new DanToast(container);DanToast.instances.push(instance)})}