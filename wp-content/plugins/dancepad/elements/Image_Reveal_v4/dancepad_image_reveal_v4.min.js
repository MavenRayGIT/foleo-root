class ImageRevealV4{static instances=[];constructor(imageReveal){this.imageReveal=imageReveal;this.timeline=null;this.observer=null;this.init()}
init(){this.imageReveal.removeAttribute('data-flickering');const isBreakdance=window.location.href.includes("breakdance_iframe");if(isBreakdance&&this.imageReveal.getAttribute('data-disable-builder')?.includes('1')){return}
const mask=this.imageReveal.querySelector('.dan-image-reveal-v4__mask');const squaresCount=parseFloat(this.imageReveal.getAttribute('data-squares-number'));const squareSize=100/squaresCount;mask.innerHTML='';const totalSquares=squaresCount*squaresCount;for(let i=0;i<totalSquares;i++){const square=document.createElement('div');square.classList.add('dan-image-reveal-v4__mask-square');const row=Math.floor(i/squaresCount);const col=i%squaresCount;Object.assign(square.style,{position:'absolute',width:`${squareSize}%`,height:`${squareSize}%`,top:`${row * squareSize}%`,left:`${col * squareSize}%`});mask.appendChild(square)}
let trigger=this.imageReveal.getAttribute('data-trigger');if(trigger==='this')trigger=this.imageReveal;const animationType=this.imageReveal.getAttribute("data-animationType");const removeScroll=this.imageReveal.getAttribute("data-remove-scroll")==='1';const classTriggerClick=this.imageReveal.getAttribute("data-classTriggerClick");const classTriggerHover=this.imageReveal.getAttribute("data-classTriggerHover");const containerAnimation=this.getHorizontalScrollContainerName(this.imageReveal);const squares=Array.from(mask.querySelectorAll('.dan-image-reveal-v4__mask-square'));const shuffledSquares=[...squares].sort(()=>Math.random()-0.5);this.timeline=gsap.timeline({scrollTrigger:{trigger:trigger,start:this.imageReveal.getAttribute('data-start'),end:this.imageReveal.getAttribute('data-end'),scrub:this.imageReveal.getAttribute('data-scrub')==='1',toggleActions:this.imageReveal.getAttribute('data-toggle-actions'),containerAnimation:containerAnimation?window[containerAnimation]:undefined}});this.timeline.to(shuffledSquares,{opacity:0,duration:parseFloat(this.imageReveal.getAttribute('data-duration')),delay:parseFloat(this.imageReveal.getAttribute('data-delay')),stagger:parseFloat(this.imageReveal.getAttribute('data-stagger')),ease:this.imageReveal.getAttribute('data-ease')});if(animationType==="click"&&classTriggerClick&&parseFloat(classTriggerClick)!==0){document.querySelectorAll(classTriggerClick).forEach(el=>el.addEventListener('click',()=>this.timeline.restart()))}
if(animationType==="hover"&&classTriggerHover&&parseFloat(classTriggerHover)!==0){document.querySelectorAll(classTriggerHover).forEach(el=>el.addEventListener('mouseover',()=>this.timeline.restart()))}
if(removeScroll){this.timeline.progress(1)}}
play(){if(this.timeline.isActive()){this.timeline.play()}else{this.timeline.restart()}}
reverse(){this.timeline.reverse()}
destroy(){if(this.observer)this.observer.disconnect();if(this.timeline?.scrollTrigger){this.timeline.scrollTrigger.kill();this.timeline.kill()}
const mask=this.imageReveal.querySelector('.dan-image-reveal-v4__mask');if(mask)mask.innerHTML=''}
getHorizontalScrollContainerName(element){let containerName=null;document.querySelectorAll('.dan-horizontal-scroll').forEach((scroll,index)=>{if(scroll.contains(element)){containerName=`NextHorizontalScroll${index}`}});return containerName}
static destroyAllInstances(){ImageRevealV4.instances.forEach(instance=>instance.destroy());ImageRevealV4.instances=[]}}
function dancepad_image_reveal_v4(){if(document.querySelector(".dan-site-loader")&&!window.location.href.includes("breakdance_iframe")){return}
ImageRevealV4.destroyAllInstances();document.querySelectorAll('.dan-image-reveal-v4').forEach(imageReveal=>{const instance=new ImageRevealV4(imageReveal);ImageRevealV4.instances.push(instance)})}
function dancepad_image_reveal_v4_site_loader(){ImageRevealV4.destroyAllInstances();document.querySelectorAll('.dan-image-reveal-v4').forEach(imageReveal=>{const instance=new ImageRevealV4(imageReveal);ImageRevealV4.instances.push(instance)})}