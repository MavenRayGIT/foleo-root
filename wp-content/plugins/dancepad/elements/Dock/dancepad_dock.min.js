class NextDockMenu{constructor(element){this.element=element;this.app=null;this.config=this.initConfig();this.setInitialHeight();this.init()}
static instances=[];static destroyAll(){NextDockMenu.instances.forEach((instance)=>instance.destroy());NextDockMenu.instances=[]}
setInitialHeight(){const realHeight=Math.max(this.element.scrollHeight,this.element.offsetHeight,this.element.clientHeight);this.element.style.height=`${realHeight}px`;this.originalHeight=realHeight}
initConfig(){return{baseSize:parseFloat(this.element.getAttribute("data-base-size")),scale:parseFloat(this.element.getAttribute("data-scale")),activationDistance:parseFloat(this.element.getAttribute("data-activation-distance"))}}
createNextBricksDock(customScale,activationDistance,baseSize){const NextBricksDock=(context)=>{let items;let root;context.subscribeToEvents((eventBus)=>{eventBus.subscribeToEvent(Veloxi.Events.PointerMoveEvent,onMouseMove)});function onMouseMove(event){if(!root||!root.intersects)return;if(!root.intersects(event.x,event.y)){items.forEach((item)=>{item.size.reset()});return}
items.forEach((item)=>{const currentSize=parseFloat(getComputedStyle(item.element).getPropertyValue('--dimensions'));const scaledActivationDistance=activationDistance*(currentSize/40);const progress=Veloxi.Utils.pointToViewProgress({x:event.x,y:event.y},item,scaledActivationDistance);const scale=Veloxi.Utils.remap(progress,0,1,1,customScale);item.size.set({width:currentSize*scale,height:currentSize*scale})})}
context.setup(()=>{root=context.getView("root");items=context.getViews("item");items.forEach((item)=>{item.size.setAnimator("dynamic");item.origin.set({x:0.5,y:1})})})};NextBricksDock.pluginName="NextBricksDock";return NextBricksDock}
init(){const{createApp}=Veloxi;this.app=createApp();const NextBricksDockPlugin=this.createNextBricksDock(this.config.scale,this.config.activationDistance,this.config.baseSize);this.app.addPlugin(NextBricksDockPlugin);this.app.run(this.element)}
destroy(){if(this.app?.stop){this.app.stop()}
const items=this.element.querySelectorAll('[data-view="item"]');items.forEach((item)=>{item.style.width="";item.style.height="";item.style.transform=""});if(this.element){this.element.style.height=""}
this.element=null;this.app=null}}
function dancepad_dock(){NextDockMenu.destroyAll();document.querySelectorAll(".dan-dock-menu").forEach((element)=>{const instance=new NextDockMenu(element);NextDockMenu.instances.push(instance)});initializeDockObserver()}
function initializeDockObserver(){const breakdanceCanvas=document.querySelector("#breakdance_canvas");if(!breakdanceCanvas)return;const observer=new MutationObserver((mutations)=>{for(const mutation of mutations){if(mutation.type==="childList"){const hasChanges=[...mutation.addedNodes,...mutation.removedNodes].some((node)=>node.classList&&node.classList.contains("dan-dock-menu__item"));if(hasChanges){dancepad_dock();break}}}});const sliderElements=document.querySelectorAll(".dan-dock-menu");sliderElements.forEach((element)=>{observer.observe(element,{childList:!0,subtree:!0})});return observer}