class NextDropdown{constructor(element,index){this.dropdown=element;this.index=index;this.config={trigger:element.getAttribute('data-trigger'),toggle:element.getAttribute('data-toggle'),closeClick:element.getAttribute('data-closeclick')==='1',closeEsc:element.getAttribute('data-closeesc')==='1'};this.init()}
static instances=[];static destroyAll(){NextDropdown.instances.forEach(instance=>instance.destroy());NextDropdown.instances=[]}
init(){this.setupToggle();this.setupEventListeners()}
setupToggle(){if(!this.config.toggle&&this.dropdown.closest('.dan-dropdown-wrapper')){const wrapper=this.dropdown.closest('.dan-dropdown-wrapper');this.toggle=this.config.trigger==='click'?wrapper.querySelector('.dan-dropdown-toggle'):wrapper;const toggleClass=`dan-dropdown-wrapper--dropdown-${this.index}`;this.toggle.classList.add(toggleClass);this.config.toggle=toggleClass;this.setupDropdownEvents(this.toggle)}else{document.querySelectorAll('.'+this.config.toggle).forEach(toggle=>{this.setupDropdownEvents(toggle)})}}
setupEventListeners(){document.addEventListener('mousedown',this.handleClickOutside.bind(this));document.addEventListener('keydown',this.handleEscKey.bind(this));this.dropdown.addEventListener('focusout',this.handleFocusOut.bind(this));if(this.toggle){this.toggle.addEventListener('focusout',this.handleToggleFocusOut.bind(this))}}
setupDropdownEvents(toggle){if(this.config.trigger==='click'){this.setupClickEvents(toggle)}else if(this.config.trigger==='hover'){this.setupHoverEvents(toggle)}
this.setupKeyboardEvents(toggle);this.setupAccessibility(toggle)}
handleClickOutside(event){if(this.config.closeClick){if(!this.dropdown.contains(event.target)&&!this.toggle.contains(event.target)){this.closeDropdown()}}}
handleEscKey(event){if(this.config.closeEsc&&event.key==='Escape'&&this.dropdown.hasAttribute('data-toggled')){event.preventDefault();this.closeDropdown();if(this.config.trigger==='hover'&&document.activeElement===this.toggle){this.toggle.blur()}}}
handleFocusOut(event){if(!this.dropdown.contains(event.relatedTarget)&&(!this.toggle||!this.toggle.contains(event.relatedTarget))){this.closeDropdown()}}
handleToggleFocusOut(event){if(!this.dropdown.contains(event.relatedTarget)&&!this.toggle.contains(event.relatedTarget)){this.closeDropdown();this.updateArrowIcons(!1)}}
openDropdown(){this.dropdown.setAttribute('data-toggled','');this.dropdown.removeAttribute('inert');this.toggle.setAttribute('aria-expanded','true')}
closeDropdown(){if(this.dropdown.hasAttribute('data-toggled')){this.dropdown.removeAttribute('data-toggled');this.dropdown.setAttribute('inert','');if(this.toggle){this.toggle.setAttribute('aria-expanded','false');this.updateArrowIcons(!1)}}}
toggleDropdown(){const isOpen=this.dropdown.hasAttribute('data-toggled');if(isOpen){this.closeDropdown()}else{this.openDropdown()}}
destroy(){document.removeEventListener('mousedown',this.handleClickOutside);document.removeEventListener('keydown',this.handleEscKey);this.dropdown.removeEventListener('focusout',this.handleFocusOut);if(this.toggle){this.toggle.removeEventListener('focusout',this.handleToggleFocusOut);const toggleClass=`dan-dropdown-wrapper--dropdown-${this.index}`;this.toggle.classList.remove(toggleClass)}
this.dropdown.removeAttribute('data-toggled');this.dropdown.removeAttribute('inert');this.dropdown=null;this.toggle=null}
setupClickEvents(toggle){toggle.addEventListener('click',()=>this.toggleDropdown())}
setupHoverEvents(toggle){toggle.addEventListener('mouseenter',()=>this.openDropdown());toggle.addEventListener('mouseleave',()=>this.closeDropdown());this.dropdown.addEventListener('mouseenter',()=>this.openDropdown());this.dropdown.addEventListener('mouseleave',()=>this.closeDropdown())}
setupKeyboardEvents(toggle){toggle.addEventListener('keydown',(event)=>{if(event.key==='Enter'||event.key===' '){event.preventDefault();this.toggleDropdown()}})}
setupAccessibility(toggle){if(!toggle.getAttribute('tabindex')){toggle.setAttribute('tabindex','0')}
toggle.setAttribute('role','button');toggle.setAttribute('aria-expanded','false');toggle.setAttribute('aria-controls',`dropdown-${this.index}`);this.dropdown.id=`dropdown-${this.index}`}
updateArrowIcons(isActive){if(this.toggle){const arrowIcons=this.toggle.querySelectorAll('.dan-arrow-icon');arrowIcons.forEach(icon=>{icon.setAttribute('data-active',isActive?'true':'false')})}}}
function dancepad_dropdown(){NextDropdown.destroyAll();document.querySelectorAll('.dan-dropdown').forEach((element,index)=>{const instance=new NextDropdown(element,index);NextDropdown.instances.push(instance)})}