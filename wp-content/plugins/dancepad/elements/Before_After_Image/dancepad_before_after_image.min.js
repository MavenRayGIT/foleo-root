class NextBeforeAfterImage{constructor(element){this.wrapper=element;this.beforeImage=element.querySelector(".dan-before-after-image__before .breakdance-image-object");this.afterImage=element.querySelector(".dan-before-after-image__after .breakdance-image-object");this.afterWrapper=element.querySelector(".dan-before-after-image__after");this.scroller=element.querySelector(".dan-before-after-image__scroller");this.isDragging=!1;this.config={showAfter:this.parseShowAfterValue(element.getAttribute("data-showafter"))};this.handleResize=this.handleResize.bind(this);this.handleDragStart=this.handleDragStart.bind(this);this.handleDragEnd=this.handleDragEnd.bind(this);this.handleDragMove=this.handleDragMove.bind(this);this.init();element.removeAttribute("data-flickering")}
static instances=[];static destroyAll(){NextBeforeAfterImage.instances.forEach((instance)=>instance.destroy());NextBeforeAfterImage.instances=[]}
init(){this.setAfterDimensions();this.bindEvents();this.setPosition(this.config.showAfter)}
setAfterDimensions(){const width=this.beforeImage.clientWidth;const height=this.beforeImage.clientHeight;this.afterImage.style.width=`${width}px`;this.afterImage.style.height=`${height}px`}
bindEvents(){window.addEventListener("resize",this.handleResize);this.scroller.addEventListener("mousedown",this.handleDragStart);this.scroller.addEventListener("touchstart",this.handleDragStart);document.body.addEventListener("mouseup",this.handleDragEnd);document.body.addEventListener("mouseleave",this.handleDragEnd);document.body.addEventListener("touchend",this.handleDragEnd);document.body.addEventListener("touchcancel",this.handleDragEnd);document.body.addEventListener("mousemove",this.handleDragMove);document.body.addEventListener("touchmove",this.handleDragMove)}
setPosition(position){const constrainedPosition=Math.max(0,Math.min(position,this.wrapper.offsetWidth));this.afterWrapper.style.width=`${constrainedPosition}px`;const scrollerOffset=constrainedPosition-this.scroller.offsetWidth/2;this.scroller.style.left=`${scrollerOffset}px`}
handleResize(){dancepad_before_after_image()}
handleDragStart(event){event.preventDefault();this.isDragging=!0;this.scroller.classList.add("dan-before-after-image__scrolling");const pageX=event.type==="touchstart"?event.touches[0].pageX:event.pageX;const position=pageX-this.wrapper.getBoundingClientRect().left;this.setPosition(position)}
handleDragEnd(){this.isDragging=!1;this.scroller.classList.remove("dan-before-after-image__scrolling")}
handleDragMove(event){if(!this.isDragging)return;const pageX=event.type==="touchmove"?event.touches[0].pageX:event.pageX;const position=pageX-this.wrapper.getBoundingClientRect().left;this.setPosition(position)}
destroy(){window.removeEventListener("resize",this.handleResize);this.scroller.removeEventListener("mousedown",this.handleDragStart);this.scroller.removeEventListener("touchstart",this.handleDragStart);document.body.removeEventListener("mouseup",this.handleDragEnd);document.body.removeEventListener("mouseleave",this.handleDragEnd);document.body.removeEventListener("touchend",this.handleDragEnd);document.body.removeEventListener("touchcancel",this.handleDragEnd);document.body.removeEventListener("mousemove",this.handleDragMove);document.body.removeEventListener("touchmove",this.handleDragMove);this.wrapper=null;this.beforeImage=null;this.afterImage=null;this.afterWrapper=null;this.scroller=null}
parseShowAfterValue(value){if(!value)return 50;if(value.toString().includes('%')){const percentage=parseFloat(value)/100;return this.wrapper.offsetWidth*percentage}
return parseFloat(value)}}
function dancepad_before_after_image(){NextBeforeAfterImage.destroyAll();document.querySelectorAll(".dan-before-after-image").forEach((element)=>{const instance=new NextBeforeAfterImage(element);NextBeforeAfterImage.instances.push(instance)})}