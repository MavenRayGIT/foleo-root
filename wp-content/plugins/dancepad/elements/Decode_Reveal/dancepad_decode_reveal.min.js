class NextDecodeReveal{static instances=[];constructor(element){this.element=element;this.inner=element.querySelector(".dan-decode-reveal__inner");this.delay=parseFloat(element.getAttribute("data-stagger")||"0");this.duration="20";this.ease=element.getAttribute("data-ease")||"none";this.decodeAlphabet=[...(element.getAttribute("data-decodealphabet")||"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789")];this.fromRight=element.getAttribute("data-from-right")==="1";this.start=element.getAttribute("data-start")||"top center";this.end=element.getAttribute("data-end")||"+=50%";this.trigger=element.getAttribute("data-trigger")==="this"?element:element.getAttribute("data-trigger");this.toggleActions=element.getAttribute("data-toggleactions")||"play none none reverse";this.scrub=element.getAttribute("data-scrub")==="1";this.animationType=element.getAttribute("data-additional_triggers");this.triggerElement=element.getAttribute("data-element");this.initialize();this.setupTriggers()}
initialize(){this.originalText=this.inner.innerHTML.split("");this.scrambledText=[];this.originalText.forEach((_,index)=>{this.scrambledText[index]=this.getRandomChar()});this.inner.innerHTML=this.scrambledText.join("");this.createAnimation()}
setupTriggers(){if(this.animationType==="click"&&this.triggerElement){document.querySelectorAll(this.triggerElement).forEach((trigger)=>{trigger.addEventListener("click",()=>{this.createAnimation()})})}else if(this.animationType==="hover"&&this.triggerElement){document.querySelectorAll(this.triggerElement).forEach((trigger)=>{trigger.addEventListener("mouseenter",()=>{this.createAnimation()})})}}
getRandomChar(){const char=this.decodeAlphabet[Math.floor(Math.random()*this.decodeAlphabet.length)];return Math.random()>0.5?char:char.toUpperCase()}
createAnimation(){const containerName=[...document.querySelectorAll(".dan-horizontal-scroll")].findIndex((scroll)=>scroll.contains(this.element));let lastProgress=0;this.animation=gsap.timeline({scrollTrigger:{trigger:this.trigger,containerAnimation:containerName!==-1?window[`NextHorizontalScroll${containerName}`]:undefined,start:this.start,end:this.end,toggleActions:this.toggleActions,scrub:this.scrub,},});this.animation.to(this.inner,{duration:this.originalText.length/this.duration,ease:this.ease,delay:this.delay,onUpdate:()=>{const currentProgress=Math.floor(this.animation.progress()*this.originalText.length);if(lastProgress!==currentProgress){lastProgress=currentProgress;this.updateText(currentProgress)}},})}
updateText(currentProgress){this.originalText.forEach((_,index)=>{this.scrambledText[index]=this.getRandomChar()});let visibleOriginal,visibleScrambled;if(this.fromRight){visibleOriginal=this.scrambledText.join("").substring(0,this.scrambledText.length-currentProgress);visibleScrambled=this.originalText.join("").substring(this.originalText.length-currentProgress)}else{visibleOriginal=this.originalText.join("").substring(0,currentProgress);visibleScrambled=this.scrambledText.join("").substring(currentProgress)}
this.inner.innerHTML=visibleOriginal+visibleScrambled}
restartAnimation(){let progress=0;const totalSteps=this.originalText.length;const stepDuration=20;if(this.animationInterval){clearInterval(this.animationInterval)}
this.inner.innerHTML=this.scrambledText.join("");this.animationInterval=setInterval(()=>{progress++;this.updateText(progress);if(progress>=totalSteps){clearInterval(this.animationInterval)}},stepDuration)}
destroy(){if(this.animation?.scrollTrigger){this.animation.scrollTrigger.kill()}
if(this.animation){this.animation.kill()}
if(this.animationInterval){clearInterval(this.animationInterval)}}
static destroyAll(){NextDecodeReveal.instances.forEach((instance)=>instance.destroy());NextDecodeReveal.instances=[]}}
function dancepad_decode_reveal(){if(document.querySelector(".dan-site-loader")&&!window.location.href.includes("breakdance_iframe")){return}
gsap.registerPlugin(ScrollTrigger);NextDecodeReveal.destroyAll();document.querySelectorAll(".dan-decode-reveal").forEach((element)=>{element.removeAttribute("data-flickering");NextDecodeReveal.instances.push(new NextDecodeReveal(element))});return NextDecodeReveal.instances}
function dancepad_decode_reveal_site_loader(){gsap.registerPlugin(ScrollTrigger);NextDecodeReveal.destroyAll();document.querySelectorAll(".dan-decode-reveal").forEach((element)=>{element.removeAttribute("data-flickering");NextDecodeReveal.instances.push(new NextDecodeReveal(element))});return NextDecodeReveal.instances}