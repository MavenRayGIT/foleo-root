class NextStackingCards{constructor(element){this.element=element;this.cards=[...element.querySelectorAll(".dan-stacking-cards__card")];this.timelines=[];this.config=this.initConfig();this.init()}
static instances=[];static destroyAll(){NextStackingCards.instances.forEach((instance)=>instance.destroy());NextStackingCards.instances=[]}
initConfig(){return{finalBrightness:this.element.getAttribute("data-final-brightness"),scale:parseFloat(this.element.getAttribute("data-scale")),borderRadius:parseFloat(this.element.getAttribute("data-border-radius")),start:this.element.getAttribute("data-start"),end:this.element.getAttribute("data-end"),easing:this.element.getAttribute("data-easing"),}}
createCardAnimation(card,position){const isLast=position===this.cards.length-1;const timeline=gsap.timeline({scrollTrigger:{trigger:card,start:this.config.start,end:this.config.end,scrub:!0}});timeline.to(card,{ease:this.config.easing,startAt:{filter:"brightness(100%)"},filter:isLast?"none":`brightness(${parseFloat(this.config.finalBrightness)}%)`,scale:this.config.scale,borderRadius:this.config.borderRadius},0);this.timelines.push(timeline)}
init(){this.cards.forEach((card,index)=>{this.createCardAnimation(card,index)})}
destroy(){this.timelines.forEach((timeline)=>{if(timeline.scrollTrigger){timeline.scrollTrigger.kill()}
timeline.kill()});this.cards.forEach((card)=>{gsap.set(card,{clearProps:"all"})});this.timelines=[];this.cards=[];this.element=null}}
function dancepad_stacking_cards(){NextStackingCards.destroyAll();document.querySelectorAll(".dan-stacking-cards").forEach((element)=>{const instance=new NextStackingCards(element);NextStackingCards.instances.push(instance)});initializeStackingCardsObserver()}
function initializeStackingCardsObserver(){const breakdanceCanvas=document.querySelector('#breakdance_canvas');if(!breakdanceCanvas)return;const observer=new MutationObserver((mutations)=>{for(const mutation of mutations){if(mutation.type==='childList'){const hasChanges=[...mutation.addedNodes,...mutation.removedNodes].some(node=>node.classList&&(node.classList.contains('dan-stacking-cards__card')));if(hasChanges){dancepad_stacking_cards();break}}}});const sliderElements=document.querySelectorAll('.dan-stacking-cards');sliderElements.forEach(element=>{observer.observe(element,{childList:!0,subtree:!0})});return observer}