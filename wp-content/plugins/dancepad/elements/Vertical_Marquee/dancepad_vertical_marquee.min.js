class NextVerticalMarquee{constructor(element){this.element=element;this.wrapper=element.querySelector(".dan-vertical-marquee__wrapper");this.isPreview=window.location.href.includes("breakdance_iframe");this.animation=null;this.config=this.initConfig();this.init()}
static instances=[];static destroyAll(){NextVerticalMarquee.instances.forEach((instance)=>instance.destroy());NextVerticalMarquee.instances=[]}
initConfig(){return{disableBuilder:this.element.getAttribute("data-disable-builder")==="1",reverse:this.element.getAttribute("data-reverse")==="1",pauseOnHover:this.element.getAttribute("data-pauseonhover")==="1",duration:parseFloat(this.element.getAttribute("data-duration")),easing:this.element.getAttribute("data-easing"),gap:parseFloat(window.getComputedStyle(this.element).getPropertyValue("--gap")),}}
createClone(){const clone=this.wrapper.cloneNode(!0);clone.classList.add("clone");this.element.appendChild(clone);const height=this.wrapper.getBoundingClientRect().height;this.element.style.maxHeight=`${height}px`;return height}
createAnimation(height){const distance=height+this.config.gap;const yValue=this.config.reverse?distance:-distance;this.animation=gsap.to(this.element.querySelectorAll(".dan-vertical-marquee__wrapper"),{duration:this.config.duration,y:yValue,repeat:-1,ease:this.config.easing,onRepeat:()=>this.handleRepeat()});if(this.isPreview&&this.config.disableBuilder){this.animation.pause()}}
handleRepeat(){const isCloneFirst=this.element.firstElementChild.classList.contains("clone");const elementToMove=isCloneFirst?this.element.querySelector(".dan-vertical-marquee__wrapper.clone"):this.element.querySelector(".dan-vertical-marquee__wrapper:not(.clone)");if(elementToMove){this.element.removeChild(elementToMove);this.element.appendChild(elementToMove)}}
bindEvents(){if(!this.isPreview||!this.config.disableBuilder){if(this.config.pauseOnHover){this.element.addEventListener("mouseenter",()=>this.animation?.pause());this.element.addEventListener("mouseleave",()=>this.animation?.play())}}}
init(){const height=this.createClone();this.createAnimation(height);this.bindEvents()}
destroy(){if(this.animation){this.animation.kill()}
const wrappers=this.element?.querySelectorAll(".dan-vertical-marquee__wrapper");if(wrappers){gsap.set(wrappers,{clearProps:"all"})}
if(this.config?.pauseOnHover){this.element?.removeEventListener("mouseenter",()=>this.animation?.pause());this.element?.removeEventListener("mouseleave",()=>this.animation?.play())}
const clone=this.element?.querySelector(".dan-vertical-marquee__wrapper.clone");if(clone){clone.remove()}
if(this.element){gsap.set(this.element,{clearProps:"all"});this.element.style.maxHeight=""}
this.element=null;this.wrapper=null;this.animation=null}}
function dancepad_vertical_marquee(){NextVerticalMarquee.destroyAll();document.querySelectorAll(".dan-vertical-marquee").forEach((element)=>{const instance=new NextVerticalMarquee(element);NextVerticalMarquee.instances.push(instance)});initializeVerticalMarqueeObserver()}
function initializeVerticalMarqueeObserver(){const breakdanceCanvas=document.querySelector('#breakdance_canvas');if(!breakdanceCanvas)return;const observer=new MutationObserver((mutations)=>{for(const mutation of mutations){if(mutation.type==='childList'){const hasChanges=[...mutation.addedNodes,...mutation.removedNodes].some(node=>node.classList&&(!node.classList.contains('dan-vertical-marquee__wrapper')));if(hasChanges){dancepad_vertical_marquee();break}}}});const sliderElements=document.querySelectorAll('.dan-vertical-marquee');sliderElements.forEach(element=>{observer.observe(element,{childList:!0,subtree:!0})});return observer}