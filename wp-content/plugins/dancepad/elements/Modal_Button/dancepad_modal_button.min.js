class NextModalButton{static instances=[];constructor(element){Object.assign(this,{element,itemsList:element.getElementsByClassName("dan-modal-button__list-wrapper"),menuItems:element.getElementsByClassName("dan-modal-button__item"),trigger:element.getElementsByClassName("dan-modal-button__btn"),morphBg:element.getElementsByClassName("dan-modal-button__morph-bg"),menuIsOpen:!1,menuVisibleClass:"dan-modal-button--expanded",eventListeners:[]});if(this.canInitialize()){this.initialize()}}
canInitialize(){return this.trigger.length>0&&this.morphBg.length>0&&this.itemsList.length>0}
initialize(){this.initAttributes();this.initEvents()}
initAttributes(){Array.from(this.trigger).forEach(trigger=>{trigger.setAttribute("aria-expanded","false");trigger.setAttribute("aria-haspopup","true")});Array.from(this.menuItems).forEach(item=>{item.setAttribute("tabindex","0")})}
initEvents(){this.handleTriggerClick=(e)=>{e.preventDefault();this.toggleMenu(!this.element.hasAttribute(this.menuVisibleClass),!0)};this.trigger[0].addEventListener("click",this.handleTriggerClick);this.eventListeners.push({element:this.trigger[0],type:"click",handler:this.handleTriggerClick});this.handleKeydown=(e)=>{if(!e.target.hasAttribute("dan-modal-button__item"))return;const isArrowDown=e.keyCode===40||e.key?.toLowerCase()==="arrowdown";const isArrowUp=e.keyCode===38||e.key?.toLowerCase()==="arrowup";if(isArrowDown){this.navigateItems(e,"next")}else if(isArrowUp){this.navigateItems(e,"prev")}};this.element.addEventListener("keydown",this.handleKeydown);this.eventListeners.push({element:this.element,type:"keydown",handler:this.handleKeydown})}
toggleMenu(show,focusTrigger){this.element.toggleAttribute(this.menuVisibleClass,show);this.menuIsOpen=show;this.animateBg(show);if(show){this.trigger[0].setAttribute("aria-expanded","true");if(this.menuItems[0]){this.menuItems[0].focus();this.menuItems[0].addEventListener("transitionend",()=>{this.menuItems[0].focus()},{once:!0})}}else if(this.trigger[0]){this.trigger[0].setAttribute("aria-expanded","false");if(focusTrigger)this.trigger[0].focus();}}
navigateItems(event,direction){event.preventDefault();const items=Array.from(this.menuItems);const currentIndex=items.indexOf(event.target);let nextIndex=direction==="next"?currentIndex+1:currentIndex-1;if(nextIndex<0)nextIndex=items.length-1;if(nextIndex>=items.length)nextIndex=0;items[nextIndex].focus()}
checkMenuFocus(){const activeElement=document.activeElement.closest(".dan-modal-button");if(!activeElement||!this.element.contains(activeElement)){this.toggleMenu(!1,!1)}}
checkMenuClick(target){if(!this.element.contains(target)&&!target.closest(`[aria-controls="${this.element.id}"]`)){this.toggleMenu(!1)}}
animateBg(show){if(show){const listRect=this.itemsList[0].getBoundingClientRect();const bgRect=this.morphBg[0].getBoundingClientRect();this.morphBg[0].style.transform=`translateX(${listRect.left - bgRect.left}px) 
                 translateY(${listRect.top - bgRect.top}px) 
                 translateZ(-0.1px)`;this.morphBg[0].style.height=`${listRect.height}px`;this.morphBg[0].style.width=`${listRect.width}px`}else{this.morphBg[0].style=""}}
destroy(){this.eventListeners.forEach(({element,type,handler})=>{element.removeEventListener(type,handler)});this.toggleMenu(!1,!1)}
static setupGlobalEvents(){window.addEventListener("keyup",(e)=>{if(e.key?.toLowerCase()==="tab"){NextModalButton.instances.forEach(instance=>instance.checkMenuFocus())}else if(e.key?.toLowerCase()==="escape"){NextModalButton.instances.forEach(instance=>instance.toggleMenu(!1,!0))}});window.addEventListener("click",(e)=>{NextModalButton.instances.forEach(instance=>instance.checkMenuClick(e.target))});const closeAllModals=()=>{NextModalButton.instances.forEach(instance=>{if(instance.menuIsOpen)instance.toggleMenu(!1,!1);})};window.addEventListener("resize",closeAllModals);window.addEventListener("scroll",closeAllModals)}
static destroyAll(){NextModalButton.instances.forEach(instance=>instance.destroy());NextModalButton.instances=[]}}
const dancepad_modal_button=()=>{NextModalButton.destroyAll();const elements=document.getElementsByClassName("dan-modal-button");if(elements.length>0){Array.from(elements).forEach(element=>NextModalButton.instances.push(new NextModalButton(element)));NextModalButton.setupGlobalEvents()}}