class AudioPlayer{static instances=[];constructor(player){this.player=player;this.title=player.querySelector('.dan-audio-player__name');this.subtitle=player.querySelector('.dan-audio-player__artist');this.timer=player.querySelector('.dan-audio-player__timer');this.duration=player.querySelector('.dan-audio-player__duration');this.playBtn=player.querySelector('.dan-audio-player__play');this.pauseBtn=player.querySelector('.dan-audio-player__pause');this.progress=player.querySelector('.dan-audio-player__progress');this.progressContainer=player.querySelector('.dan-audio-player__progress-container');this.source=player.getAttribute('data-source');this.durationGSAP=parseFloat(player.getAttribute('data-duration'));this.easeGSAP=player.getAttribute('data-ease');this.sliderDown=!1;this.init()}
init(){const self=this;this.audioData=[{title:this.title.innerHTML,subtitle:this.subtitle.innerHTML,howl:new Howl({src:[this.source],html5:!0,onload:function(){self.duration.innerHTML=self.formatTime(Math.round(this.duration()))},onplay:function(){requestAnimationFrame(self.step.bind(self))},onend:function(){self.pauseBtn.style.display='none';self.playBtn.style.display='flex'}})}];this.index=0;this.seeking=!1;this.playBtn.addEventListener('click',()=>this.play());this.pauseBtn.addEventListener('click',()=>this.pause());this.playBtn.addEventListener('keydown',e=>{if(e.key==='Enter')this.play();});this.pauseBtn.addEventListener('keydown',e=>{if(e.key==='Enter')this.pause();});this.progressContainer.addEventListener('click',(e)=>this.seekByClick(e));this.progressContainer.addEventListener('mousedown',()=>this.sliderDown=!0);document.addEventListener('mouseup',()=>this.sliderDown=!1);document.addEventListener('mousemove',(e)=>this.seekByMove(e));this.progressContainer.addEventListener('touchstart',()=>this.sliderDown=!0);document.addEventListener('touchend',()=>this.sliderDown=!1);document.addEventListener('touchmove',(e)=>this.seekByTouch(e))}
play(index=this.index){const data=this.audioData[index];const sound=data.howl;sound.play();this.title.innerHTML=data.title;this.subtitle.innerHTML=data.subtitle;this.playBtn.style.display='none';this.pauseBtn.style.display='flex';this.index=index}
pause(){const sound=this.audioData[this.index].howl;sound.pause();this.pauseBtn.style.display='none';this.playBtn.style.display='flex'}
step(){const sound=this.audioData[this.index].howl;let seek=sound.seek()||0;let soundDuration=sound.duration()||0;seek=Math.min(seek,soundDuration);this.timer.innerHTML=this.formatTime(Math.round(seek));if(!this.seeking){const percentage=((seek/soundDuration)*100||0)+'%';gsap.to(this.progress,{width:percentage,duration:0.1,ease:"linear"})}
if(sound.playing()){requestAnimationFrame(this.step.bind(this))}}
seek(per){const sound=this.audioData[this.index].howl;if(sound.playing()||sound.state()==='loaded'){this.seeking=!0;const duration=sound.duration();const newTime=duration*per;sound.seek(newTime);gsap.to(this.progress,{width:(per*100)+'%',duration:this.durationGSAP,ease:this.easeGSAP,onComplete:()=>{this.seeking=!1}});this.timer.innerHTML=this.formatTime(Math.round(newTime));if(sound.playing()){requestAnimationFrame(this.step.bind(this))}}}
seekByClick(event){const per=event.offsetX/this.progressContainer.offsetWidth;this.seek(per);const sound=this.audioData[this.index].howl;if(this.pauseBtn.style.display==='flex'){sound.play()}else{const seekPosition=Math.round(sound.duration()*per);this.timer.innerHTML=this.formatTime(seekPosition)}}
seekByMove(event){if(!this.sliderDown)return;const rect=this.progressContainer.getBoundingClientRect();const offsetX=event.clientX-rect.left;const per=Math.max(0,Math.min(1,offsetX/this.progressContainer.offsetWidth));this.seek(per)}
seekByTouch(event){if(!this.sliderDown)return;const touch=event.touches[0];const rect=this.progressContainer.getBoundingClientRect();const offsetX=touch.clientX-rect.left;const per=Math.max(0,Math.min(1,offsetX/this.progressContainer.offsetWidth));this.seek(per);event.preventDefault()}
formatTime(secs){const minutes=Math.floor(secs/60)||0;const seconds=Math.floor(secs-minutes*60)||0;return `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`}
destroy(){const sound=this.audioData[this.index]?.howl;if(sound){sound.unload()}}
static destroyAllInstances(){AudioPlayer.instances.forEach(instance=>instance.destroy());AudioPlayer.instances=[]}}
function dancepad_audio_player(){AudioPlayer.destroyAllInstances();document.querySelectorAll('.dan-audio-player').forEach(player=>{const instance=new AudioPlayer(player);AudioPlayer.instances.push(instance)})}