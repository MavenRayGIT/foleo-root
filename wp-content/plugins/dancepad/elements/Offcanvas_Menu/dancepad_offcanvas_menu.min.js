class NextOffcanvasMenu{constructor(element){this.menu=element;this.itemsWrapper=element.querySelector('.dan-offcanvas-menu__items-wrapper');this.backdrop=element.querySelector('.dan-offcanvas-menu__backdrop');this.burgerButtons=element.querySelectorAll('.dan-burger');this.isOpen=!1;this.hasScrollLock=!1;this.timeline=null;this.observer=null;this.config=this.initConfig();this.clipPaths=this.initClipPaths();this.toggleMenu=this.toggleMenu.bind(this);this.handleClickOutside=this.handleClickOutside.bind(this);this.handleEscKey=this.handleEscKey.bind(this);this.handleBackdropClick=this.handleBackdropClick.bind(this);this.handleFocusOut=this.handleFocusOut.bind(this);this.init()}
static instances=[];static destroyAll(){NextOffcanvasMenu.instances.forEach(instance=>instance.destroy());NextOffcanvasMenu.instances=[]}
initConfig(){return{customToggle:this.menu.getAttribute('data-customtoggle'),closeOnEsc:this.menu.getAttribute('data-close-on-esc')==='1',toggleBodyScroll:this.menu.getAttribute('data-customtoggle-lock-body-scrolling')==='1',duration:parseFloat(this.menu.getAttribute('data-duration')),easing:this.menu.getAttribute('data-easing'),type:this.menu.getAttribute('data-type')}}
initClipPaths(){const type=this.config.type;let initial,final;switch(type){case 'fromTop':initial='polygon(0 0, 100% 0, 100% 0, 0 0)';final='polygon(0 0, 100% 0, 100% 100%, 0 100%)';break;case 'fromLeft':initial='polygon(0 0, 0 0, 0 100%, 0 100%)';final='polygon(0 0, 100% 0, 100% 100%, 0 100%)';break;case 'fromRight':initial='polygon(100% 0, 100% 0, 100% 100%, 100% 100%)';final='polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%)';break;default:initial='polygon(0 0, 0 0, 0 100%, 0 100%)';final='polygon(0 0, 100% 0, 100% 100%, 0 100%)'}
return{initial,final}}
init(){if(!this.itemsWrapper)return;this.initTimeline();this.setupCustomToggles();this.bindEvents();this.setupMutationObserver();this.manipulateTabIndexes()}
initTimeline(){this.timeline=gsap.timeline({paused:!0,onStart:()=>{this.menu.setAttribute('data-hide-content','false')},onReverseComplete:()=>{if(this.itemsWrapper){this.itemsWrapper.style.clipPath=this.clipPaths.initial}
this.menu.setAttribute('data-hide-content','true')}});this.timeline.to(this.itemsWrapper,{duration:this.config.duration,clipPath:this.clipPaths.final,ease:this.config.easing})}
manipulateTabIndex(element){if(element.hasAttribute('tabindex')&&element.getAttribute('tabindex')==='-1'){element.removeAttribute('tabindex')}else{element.setAttribute('tabindex','-1')}
Array.from(element.children).forEach(child=>this.manipulateTabIndex(child))}
applyTabIndexRecursively(element){if(element.nodeType===Node.ELEMENT_NODE){if(!element.hasAttribute('tabindex')||element.getAttribute('tabindex')!=='-1'){element.setAttribute('tabindex','-1')}
Array.from(element.children).forEach(child=>this.applyTabIndexRecursively(child))}}
setupMutationObserver(){this.observer=new MutationObserver(mutations=>{mutations.forEach(mutation=>{if(mutation.type==='childList'){mutation.addedNodes.forEach(node=>{if(node.nodeType===Node.ELEMENT_NODE){this.applyTabIndexRecursively(node)}})}})});this.observer.observe(this.itemsWrapper,{childList:!0,subtree:!0})}
setupCustomToggles(){if(!this.config.customToggle)return;const toggles=document.querySelectorAll(this.config.customToggle);toggles.forEach(toggle=>{if(!toggle.hasAttribute('tabindex')){toggle.setAttribute('tabindex','0')}
toggle.addEventListener('click',()=>{this.toggleBodyScroll();this.toggleMenu()});toggle.addEventListener('keydown',(event)=>{if(event.key==='Enter'){this.toggleBodyScroll();this.toggleMenu();event.stopImmediatePropagation()}})})}
toggleMenu(){this.isOpen=!this.isOpen;this.manipulateTabIndex(this.itemsWrapper);if(this.isOpen){this.itemsWrapper.style.pointerEvents='all';this.menu.setAttribute('data-open','dan-offcanvas-menu--opened');this.timeline.play()}else{this.itemsWrapper.style.pointerEvents='none';this.menu.removeAttribute('data-open');this.timeline.reverse();const html=document.querySelector('html');if(html?.hasAttribute('dan-burger--body-toggled')){html.removeAttribute('dan-burger--body-toggled');window.lenisInstance?.start()}}
if(this.burgerButtons.length>0){this.burgerButtons.forEach(burger=>this.updateBurgerToggle(burger))}
if(this.config.customToggle){const toggles=document.querySelectorAll(this.config.customToggle);toggles.forEach(toggle=>{if(toggle.classList.contains('dan-burger')){this.updateBurgerToggle(toggle)}else{this.updateCustomToggle(toggle)}})}}
updateBurgerToggle(burger){const button=burger.querySelector('button');if(!button)return;const buttonClasses=Array.from(button.classList);const relevantClasses=buttonClasses.filter(className=>className.startsWith('dan-burger-')||className.startsWith('hamburger--'));relevantClasses.forEach(buttonClass=>{const openedClass=`${buttonClass}--opened`;if(this.isOpen){button.classList.add(openedClass)}else{button.classList.remove(openedClass)}});button.setAttribute('aria-expanded',this.isOpen?'true':'false')}
updateCustomToggle(toggle){if(this.isOpen){toggle.classList.add('opened')}else{toggle.classList.remove('opened')}}
toggleBodyScroll(){const shouldToggleScroll=this.config.toggleBodyScroll||this.hasScrollLock;if(!shouldToggleScroll)return;const html=document.querySelector('html');if(html.hasAttribute('dan-burger--body-toggled')){window.lenisInstance?.start();html.removeAttribute('dan-burger--body-toggled')}else{window.lenisInstance?.stop();html.setAttribute('dan-burger--body-toggled','')}}
handleClickOutside(event){const isClickInside=this.itemsWrapper.contains(event.target)||(this.config.customToggle&&Array.from(document.querySelectorAll(this.config.customToggle)).some(toggle=>toggle.contains(event.target)))||(this.burgerButtons&&Array.from(this.burgerButtons).some(button=>button.contains(event.target)));if(!isClickInside&&this.isOpen){this.toggleMenu();if(this.hasScrollLock||this.config.toggleBodyScroll){document.querySelector('html')?.removeAttribute('dan-burger--body-toggled');window.lenisInstance?.start()}}}
handleEscKey(event){if(this.isOpen&&this.config.closeOnEsc&&event.key==='Escape'){this.toggleMenu();if(this.config.toggleBodyScroll){document.querySelector('html')?.removeAttribute('dan-burger--body-toggled')}}}
handleBackdropClick(){if(this.isOpen){this.toggleMenu();if(this.config.toggleBodyScroll){document.querySelector('html')?.removeAttribute('dan-burger--body-toggled');window.lenisInstance?.start()}}}
handleFocusOut(event){if(event.relatedTarget&&!this.itemsWrapper.contains(event.relatedTarget)&&this.isOpen){this.toggleMenu()}}
bindEvents(){document.addEventListener('click',this.handleClickOutside);document.addEventListener('keydown',this.handleEscKey);this.backdrop?.addEventListener('click',this.handleBackdropClick);this.itemsWrapper?.addEventListener('focusout',this.handleFocusOut);this.burgerButtons.forEach(burger=>{const scrollLock=parseFloat(burger.querySelector('button')?.getAttribute('data-scroll'))===1;if(scrollLock){this.hasScrollLock=!0}
burger.addEventListener('click',this.toggleMenu)})}
manipulateTabIndexes(){if(this.itemsWrapper){this.manipulateTabIndex(this.itemsWrapper)}}
destroy(){document.removeEventListener('click',this.handleClickOutside);document.removeEventListener('keydown',this.handleEscKey);this.backdrop?.removeEventListener('click',this.handleBackdropClick);this.itemsWrapper?.removeEventListener('focusout',this.handleFocusOut);if(this.config.customToggle){document.querySelectorAll(this.config.customToggle).forEach(toggle=>{toggle.removeEventListener('click',this.toggleMenu);toggle.removeEventListener('keydown',this.toggleMenu)})}
if(this.timeline){this.timeline.kill()}
if(this.observer){this.observer.disconnect()}
if(this.isOpen){this.menu.removeAttribute('data-open');this.menu.removeAttribute('data-hide-content');document.querySelector('html')?.removeAttribute('dan-burger--body-toggled');window.lenisInstance?.start()}
if(this.itemsWrapper){this.itemsWrapper.style.pointerEvents='';this.itemsWrapper.style.clipPath=''}
this.menu=null;this.itemsWrapper=null;this.backdrop=null;this.burgerButtons=null;this.timeline=null;this.observer=null}}
function dancepad_offcanvas_menu(){NextOffcanvasMenu.destroyAll();document.querySelectorAll('.dan-offcanvas-menu').forEach(element=>{const instance=new NextOffcanvasMenu(element);NextOffcanvasMenu.instances.push(instance)})}